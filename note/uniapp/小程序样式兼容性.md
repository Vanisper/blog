**1. 编写 uniapp 组件时，需要添加一些 vue 配置：**

```ts
// 默认导出
export default {
  options: {
    addGlobalClass: true,
    virtualHost: true,
    styleIsolation: 'shared'
  }
}
// setup 模式
defineOptions({
  options: {
    addGlobalClass: true,
    virtualHost: true,
    styleIsolation: "shared",
  },
})
```
组件内部，可以新增一个 `custom-class` 的组件参数（`String` 类型），以便于外部控制其内部样式，这个参数可以直接作用于组件内部的根节点的 class 上。
> 在 h5 环境，直接编写 class、style 是可以穿透下去的，这里特别定义一个 `custom-class` 是为了兼容小程序端

更多信息详见：[小程序样式隔离](https://wot-ui.cn/guide/common-problems.html#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB)

**2. 如果要二次封装一个组件，形成一个新组件：**

- 依然还是需要配置下前面提到的 `styleIsolation: "shared"`
- 如果需要对目标组件的内部样式做修改：
  - 需要使用 `:deep()` 语法（scss、less）
  - 需要确保组件外部至少存在一个包裹节点
    - 否则在小程序端，被封装的组件外部将会出现一个虚拟节点，这个虚拟节点会挂上一个 **独属的样式 hash 类**，外部将会无法控制
    - 这个包裹节点的目的是为了将这个独属的样式 hash 的作用范围扩充，这样子至少可以通过这个真实节点控制其内部样式
  - 组件如果提供了 `custom-class`，需要将 `:deep()` 作用于这个 `custom-class`
    - 具体视情况而定
    - 样式编译时，标记了 deep 的样式类（及其内部），在编译时，将不会被挂上样式 hash，达到控制内部样式的效果
